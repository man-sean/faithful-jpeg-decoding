name: ESRGAN_x1_qf_5_deterministic_regression_mgpu_ImageNet128
model_type: SRModel
scale: 1
num_gpu: 1  # set num_gpu: 0 for cpu mode
manual_seed: 0

datasets:
  test_1:  # the 1st test dataset
    name: ImageNet
    type: JPEGDataset
#    dataroot_gt: /home/sean.man/datasets/imagenet/val/
    dataroot_gt: /home/sean.man/datasets/imagenet/val_first_2k/
#    dataroot_gt: /home/sean.man/datasets/imagenet/val_too_large/
    io_backend:
      type: disk

    gt_size: 128
    use_hflip: false
    use_rot: false
    qf: 5

#  test_2: # the 1st test dataset
#    name: BSDS500-test
#    type: JPEGDataset
#    #    dataroot_gt: /home/sean.man/datasets/imagenet/val/
#    dataroot_gt: /home/sean.man/datasets/BSDS500/test/
#    io_backend:
#      type: disk
#
#    gt_size: 128
#    use_hflip: false
#    use_rot: false
#    qf: 5

#  test_3: # the 1st test dataset
#    name: BSDS500-single
#    type: JPEGDataset
#    #    dataroot_gt: /home/sean.man/datasets/imagenet/val/
#    dataroot_gt: /home/sean.man/datasets/BSDS500/single/
#    io_backend:
#      type: disk
#
#    gt_size: 128
#    use_hflip: false
#    use_rot: false
#    qf: 5

    # data loader
#    num_worker_per_gpu: 10
#    batch_size_per_gpu: 128

# network structures
network_g:
  type: RRDBNet
  num_in_ch: 3
  num_out_ch: 3
  num_feat: 64
  num_block: 23
  scale: 1
  noise_injection: false
  noise_injection_upsample: false

# path
path:
  pretrain_network_g: /home/sean.man/faithful-jpeg-decoding/experiments/ESRGAN_x1_qf_5_deterministic_regression_mgpu_ImageNet128/models/net_g_latest.pth
  strict_load_g: true

# validation settings
val:
  save_img: false #true
  suffix: ~  # add suffix to saved images, if None, use exp name

  metrics:
#    psnr: # metric name, can be arbitrary
#      type: calculate_psnr
#      crop_border: 0
#      test_y_channel: false
    avg_psnr:
      type: calculate_avg_psnr
      expansion: 16
      crop_border: 4
      test_y_channel: false
#    ssim:
#      type: calculate_ssim
#      crop_border: 0
#      test_y_channel: false
#    faithfulness_rmse:
#      type: calculate_jpeg_faithfulness_rmse
#      crop_border: 0
#      qf: 10
#      test_y_channel: false
#      better: lower  # the lower, the better

# FID settings
#fid:
#  repeat: 1
#  opt:
#    type: calculate_fid_given_paths
#    #gt_path: /home/sean.man/datasets/imagenet/train_fid_stats.npz
#    gt_path: /home/sean.man/datasets/imagenet/val_second_5k_fid_stats.npz
#    dims: 2048
#    num_workers: 10
#    batch_size: 1
#    better: lower  # the lower, the better

# collage settings
#collage:
#  idx_to_save: [2, 997]
#  idx_to_save: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
#  idx_to_save: [0]
#  realizations: 4
